
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>run_toggle_switch</title><meta name="generator" content="MATLAB 9.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-09-02"><meta name="DC.source" content="run_toggle_switch.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1></h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">The toggle switch example</a></li><li><a href="#4">Generate and fit a family of models</a></li><li><a href="#6">Execute OED for model discrimination</a></li><li><a href="#8">Generate new pseudo experimental data</a></li><li><a href="#9">Second iteration: generate and fit a family of models</a></li><li><a href="#10">Second interation of OED for model discrimination</a></li><li><a href="#12">Generate new pseudo experimental data</a></li><li><a href="#13">Third iteration: generate and fit a family of models</a></li><li><a href="#14">Structural identifiability of the final familly of models</a></li></ul></div><h2 id="1">The toggle switch example</h2><p>This toggle switch example was generated will a Hill kinetics model trained to a subset of the data provided in Lugagne et al. 2017. The example is baised in pseudo experimental-data which means that all data is generated by the model we have previously trained. This is a standard procedure that serves as means of benchmarking the algorithm.</p><pre class="codeinput">clear <span class="string">variables</span>;
clc;
close <span class="string">all</span>;
noise_pseudo_data=0.05;
</pre><p>A number of settings is defined in the default configuration file. The assertiveness of these settings is problem dependent. Settings such as the number optimzation solver settings, the experiments considered, or number of models (sparsity cases) have default values that should be tailored to the problem.</p><pre class="codeinput">SBL_config_defaults;
</pre><p>As example we modify sbl_config.exp_idx for considering only experiments 1 and 2.</p><pre class="codeinput">sbl_config.exp_idx=1:3;
</pre><h2 id="4">Generate and fit a family of models</h2><p>We generate a family of models with SBL and fit with AMIGO+scatter search The convergence curves are given scatter search. Time courses for each modeled observable are also ploted along with the pseudo experimental data. There is substantial progess made by the parameter estimation process.</p><pre class="codeinput">MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, <span class="string">'Units'</span>, <span class="string">'Normalized'</span>, <span class="string">'OuterPosition'</span>, [0, 0.04, 1, 0.96]);
</pre><pre class="codeoutput">02-Sep-2019 17:39:15 | loop iter: 1, generating SBL data
</pre><pre class="codeoutput error">Error using readtable (line 197)
Unable to open file 'D:\H2020DSH\Data\experimental_data_loop_1.csv'.

Error in datareader_for_SBL (line 5)
T = readtable([dir_name filesep file_name]);

Error in SBL_gen_model_family (line 13)
input_data = datareader_for_SBL(sbl_config.data_dir_name,sbl_config.data_file_name,sbl_config.exp_idx,sbl_config.fid);

Error in run_toggle_switch (line 40)
MODELS=SBL_gen_model_family(sbl_config);
</pre><h2 id="6">Execute OED for model discrimination</h2><p>Optimal experimental design for model discrimination seeks to find the experiment that maximizes the predicted different between the models.</p><pre class="codeinput">modelsAfterOED=OED4SBLdiscrimination(MODELS,sbl_config);
SBL_plotDiscriminationResult(modelsAfterOED);
set(gcf, <span class="string">'Units'</span>, <span class="string">'Normalized'</span>, <span class="string">'OuterPosition'</span>, [0, 0.04, 1, 0.96]);
</pre><h2 id="8">Generate new pseudo experimental data</h2><pre class="codeinput">SBL_workdir;
data_file2_original=fullfile(SBL_work_dir,<span class="string">'Data'</span>,[<span class="string">'experimental_data_loop_'</span> num2str(1) <span class="string">'.csv'</span>]);
data_file2_pseudo=fullfile(SBL_work_dir,<span class="string">'Data'</span>,<span class="string">'experimental_data_2_pseudo.csv'</span>);
add_pseudo_data(modelsAfterOED,noise_pseudo_data,data_file2_original,data_file2_pseudo,<span class="string">'model1'</span>);
</pre><h2 id="9">Second iteration: generate and fit a family of models</h2><pre class="codeinput">sbl_config.exp_idx=[1 2 3 8];
<span class="comment">% %% Generate and fit a new family of models</span>
sbl_config.data_dir_name = fullfile(SBL_work_dir,<span class="string">'Data'</span>);
sbl_config.data_file_name = <span class="string">'experimental_data_2_pseudo.csv'</span>;
MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, <span class="string">'Units'</span>, <span class="string">'Normalized'</span>, <span class="string">'OuterPosition'</span>, [0, 0.04, 1, 0.96]);
</pre><h2 id="10">Second interation of OED for model discrimination</h2><p>Optimal experimental design for model discrimination seeks to find the experiment that maximizes the predicted different between the models.</p><pre class="codeinput">modelsAfterOED=OED4SBLdiscrimination(MODELS,sbl_config);
SBL_plotDiscriminationResult(modelsAfterOED);
set(gcf, <span class="string">'Units'</span>, <span class="string">'Normalized'</span>, <span class="string">'OuterPosition'</span>, [0, 0.04, 1, 0.96]);
</pre><h2 id="12">Generate new pseudo experimental data</h2><pre class="codeinput">SBL_workdir;
data_file2_original=fullfile(SBL_work_dir,<span class="string">'Data'</span>,<span class="string">'experimental_data_2_pseudo.csv'</span>);
data_file2_pseudo=fullfile(SBL_work_dir,<span class="string">'Data'</span>,<span class="string">'experimental_data_3_pseudo.csv'</span>);
add_pseudo_data(modelsAfterOED,noise_pseudo_data,data_file2_original,data_file2_pseudo,<span class="string">'model1'</span>);
</pre><h2 id="13">Third iteration: generate and fit a family of models</h2><pre class="codeinput">sbl_config.exp_idx=[1 2 3 8 9];
<span class="comment">% %% Generate and fit a new family of models</span>
sbl_config.data_dir_name = fullfile(SBL_work_dir,<span class="string">'Data'</span>);
sbl_config.data_file_name = <span class="string">'experimental_data_3_pseudo.csv'</span>;
MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, <span class="string">'Units'</span>, <span class="string">'Normalized'</span>, <span class="string">'OuterPosition'</span>, [0, 0.04, 1, 0.96]);
</pre><h2 id="14">Structural identifiability of the final familly of models</h2><pre class="codeinput">res=SBL_structural_identifiability(sbl_config);

text()
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016b</a><br></p></div><!--
##### SOURCE BEGIN #####


%% The toggle switch example
% This toggle switch example was generated will a Hill kinetics model
% trained to a subset of the data provided in Lugagne et al. 2017. The
% example is baised in pseudo experimental-data which means that all data
% is generated by the model we have previously trained. This is a standard
% procedure that serves as means of benchmarking the algorithm.
%

clear variables;
clc;
close all;
noise_pseudo_data=0.05;

%%
% A number of settings is defined in the default configuration file. The
% assertiveness of these settings is problem dependent. Settings such as
% the number optimzation solver settings, the experiments considered, or
% number of models (sparsity cases) have default values that should be
% tailored to the problem. 

SBL_config_defaults;

%%
% As example we modify sbl_config.exp_idx for considering only experiments 1
% and 2.

sbl_config.exp_idx=1:3;
 
%% Generate and fit a family of models

%%
% We generate a family of models with SBL and fit with AMIGO+scatter search
% The convergence curves are given scatter search. Time courses for each
% modeled observable are also ploted along with the pseudo experimental
% data. There is substantial progess made by the parameter estimation
% process. 

MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, 'Units', 'Normalized', 'OuterPosition', [0, 0.04, 1, 0.96]);

%% Execute OED for model discrimination

%% 
% Optimal experimental design for model discrimination seeks to find the
% experiment that maximizes the predicted different between the models.

modelsAfterOED=OED4SBLdiscrimination(MODELS,sbl_config);
SBL_plotDiscriminationResult(modelsAfterOED);
set(gcf, 'Units', 'Normalized', 'OuterPosition', [0, 0.04, 1, 0.96]);

%% Generate new pseudo experimental data
SBL_workdir;
data_file2_original=fullfile(SBL_work_dir,'Data',['experimental_data_loop_' num2str(1) '.csv']);
data_file2_pseudo=fullfile(SBL_work_dir,'Data','experimental_data_2_pseudo.csv');
add_pseudo_data(modelsAfterOED,noise_pseudo_data,data_file2_original,data_file2_pseudo,'model1');

%% Second iteration: generate and fit a family of models
sbl_config.exp_idx=[1 2 3 8];
% %% Generate and fit a new family of models
sbl_config.data_dir_name = fullfile(SBL_work_dir,'Data');
sbl_config.data_file_name = 'experimental_data_2_pseudo.csv';
MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, 'Units', 'Normalized', 'OuterPosition', [0, 0.04, 1, 0.96]);

%% Second interation of OED for model discrimination

%% 
% Optimal experimental design for model discrimination seeks to find the
% experiment that maximizes the predicted different between the models.

modelsAfterOED=OED4SBLdiscrimination(MODELS,sbl_config);
SBL_plotDiscriminationResult(modelsAfterOED);
set(gcf, 'Units', 'Normalized', 'OuterPosition', [0, 0.04, 1, 0.96]);

%% Generate new pseudo experimental data
SBL_workdir;
data_file2_original=fullfile(SBL_work_dir,'Data','experimental_data_2_pseudo.csv');
data_file2_pseudo=fullfile(SBL_work_dir,'Data','experimental_data_3_pseudo.csv');
add_pseudo_data(modelsAfterOED,noise_pseudo_data,data_file2_original,data_file2_pseudo,'model1');


%% Third iteration: generate and fit a family of models
sbl_config.exp_idx=[1 2 3 8 9];
% %% Generate and fit a new family of models
sbl_config.data_dir_name = fullfile(SBL_work_dir,'Data');
sbl_config.data_file_name = 'experimental_data_3_pseudo.csv';
MODELS=SBL_gen_model_family(sbl_config);
SBL_plotFamilyFit(MODELS);
set(gcf, 'Units', 'Normalized', 'OuterPosition', [0, 0.04, 1, 0.96]);


%% Structural identifiability of the final familly of models

%% 
% 

res=SBL_structural_identifiability(sbl_config);

text()







##### SOURCE END #####
--></body></html>